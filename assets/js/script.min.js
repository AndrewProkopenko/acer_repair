
 
$(document).on('click', 'a.js-link', scrollToLink);
$(document).on('click', 'a.js-link-top', scrollToLink);

function scrollToLink() {
    $("html, body").animate({
        scrollTop: $($(this).attr("href")).offset().top - 40 + "px"
    }, {
        duration: 400,
        easing: "swing"
        });
    return false;
}
// js-form-service
$('*[data-service]').click( function(e) {  
    $('#js-form-service')[0].value = $(e.currentTarget).attr('data-service')
})
 
// header btn click function
$(document).ready(function () {
    $("a.js-link").click(function (e) {
        e.preventDefault(); 
        $('.navbar-collapse.show').collapse('hide');
        $('.js-navbar-toggle span').toggleClass('d-none')
    $('.js-navbar-toggle svg').toggleClass('d-none') 
    });
});
      
$('.js-navbar-toggle').click( headerBtnTimes)

function headerBtnTimes() { 
  $('.js-navbar-toggle span').toggleClass('d-none')
  $('.js-navbar-toggle svg').toggleClass('d-none')
}
 
$('#myModal').on('shown.bs.modal', function () {
    $('#myInput').trigger('focus')
})
 
    new Selectr('#yourcity', { 
        searchable: false
    }); 

    let swiperData = [];
    if($(document).innerWidth() > 992)  {
        swiperData = [
            'Ноутбук Acer Aspire: 5520G',
            'Ноутбук Acer Aspire: 7520G',
            'Ноутбук Acer Aspire: 8930G',
            'Ноутбук Acer Aspire: 9300'
        ]
    } else { 
        swiperData = [
            'Acer Aspire: 5520G',
            'Acer Aspire: 7520G',
            'Acer Aspire: 8930G',
            'Acer Aspire: 9300'
        ]
    }
   
  
      var swiper = new Swiper('.swiper-container', {
          loop: true,
          slidesPerView: 1,  
          navigation: {
              nextEl: '.swiper-button-next',
              prevEl: '.swiper-button-prev',
          },
          
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
            renderBullet: function (index, className) {
              return '<span class="' + className + '">' + swiperData[index] + '</span>';
            },
          },
      });

// header sticty function
$(window).scroll(setScrollHeader);

$(window).on('load', setScrollHeader)

function setScrollHeader() {
    if ($(this).scrollTop() > 1){  
        $('header').addClass("sticky");
    }
    else{
        $('header').removeClass("sticky");
    }
}
// let days1 = document.querySelector('.body-timer .days span:first-child')
// let days2 = document.querySelector('.body-timer .days span:nth-child(2)')
// let hour1 = document.querySelector('.body-timer .hour span:first-child')
// let hour2 = document.querySelector('.body-timer .hour span:nth-child(2)')
// let minute1 = document.querySelector('.body-timer .minute span:first-child')
// let minute2 = document.querySelector('.body-timer .minute span:nth-child(2)')
// let second1 = document.querySelector('.body-timer .second span:first-child')
// let second2 = document.querySelector('.body-timer .second span:nth-child(2)')

// function timer() {
//     var nowDate = new Date();
//     var achiveDate = new Date(2020,08,01,0,0,0); //Задаем дату, к которой будет осуществляться обратный отсчет
//     var result = (achiveDate - nowDate)+1000;
//     if (result < 0) {
//         var elmnt = document.getElementById('timer');
//         elmnt.innerHTML = ' - : - - : - - : - - ';
//         return undefined;
//     }
//     var seconds = Math.floor((result/1000)%60);
//     var minutes = Math.floor((result/1000/60)%60);
//     var hours = Math.floor((result/1000/60/60)%24);
//     var days = Math.floor(result/1000/60/60/24);
//     if (seconds < 10) seconds = '0' + seconds;
//     if (minutes < 10) minutes = '0' + minutes;
//     if (hours < 10) hours = '0' + hours;
    
//     var elmnt = document.getElementById('timer');
     
//     seconds = seconds.toString()
//     minutes = minutes.toString()
//     hours = hours.toString()
//     days = days.toString()

//     days1.innerHTML = days[0] 
//     days2.innerHTML = days[1] 
//     hour1.innerHTML = hours[0] 
//     hour2.innerHTML = hours[1] 
//     minute1.innerHTML = minutes[0] 
//     minute2.innerHTML = minutes[1]  
//     second1.innerHTML = seconds[0]  
//     second2.innerHTML = seconds[1]  
     
//     setTimeout(timer, 1000);
// }
// timer(); 
 
;(function(){

            
    let dis = document.querySelector('.timer');
    let hour = document.querySelector('.timer .hour');
    let minute = document.querySelector('.timer .minute');
    let second = document.querySelector('.timer .second');
    let finishTime;
    let savedTime;
    let timerLength = 3600 * 1000
    let timeoutID;


    if(localStorage.getItem('timerFinishTime')){
        UpdateTimer(); 
        
    }else{
        UpdateTimerDis(timerLength);
    }
    

    if(localStorage.getItem('timerSavedTime')){
        let savedTime = localStorage.getItem('timerSavedTime') * 1;
    UpdateTimerDis(savedTime);
    }

    function UpdateTimer() {
        finishTime = localStorage.getItem('timerFinishTime');
        let timeLeft = (finishTime - new Date());
        
            if(timeLeft > 0){
                timeoutID = window.setTimeout(UpdateTimer, 1000);
            }else{
                timeLeft = 0;
                if (timeoutID != undefined) window.clearTimeout(timeoutID);
                 
                localStorage.removeItem('timerIsRunning');
                localStorage.removeItem('timerFinishTime');
                localStorage.removeItem('timerSavedTime');
                timerLength = 3600 * 1000
            }
            UpdateTimerDis(timeLeft);
    }

    function UpdateTimerDis(millis) {
        millisToMinutesAndSeconds(millis);
        // dis.innerHTML = millisToMinutesAndSeconds(millis);
        // for(let i = 0; i < dis.length; i++) { 
        //     dis[i].innerHTML = millisToMinutesAndSeconds(millis);
        // }
    }

    function StartTimer() { 
        
        if(localStorage.getItem('timerSavedTime')){
            savedTime = localStorage.getItem('timerSavedTime') * 1;
            localStorage.removeItem('timerSavedTime');
        }else{
            savedTime = timerLength;
        }
        
        localStorage.setItem('timerIsRunning', true);
        localStorage.setItem('timerFinishTime', ((new Date()).getTime() + savedTime));
        if (timeoutID != undefined) window.clearTimeout(timeoutID);
        UpdateTimer();
    } 

    function millisToMinutesAndSeconds(millis) {
            let hours = Math.floor(millis / 3600000);
            if(hours < 1){
                hours = '00';
            }
            if(hours === '00') { 
                hour.classList.add('zero-text')
            }   else {  
                hour.classList.remove('zero-text')
            }

            let minutes = (Math.floor(millis / 60000))-(hours*60);
            if(minutes > 59){
                minutes = 0;
            }
            if (minutes < 10) {
                minutes = '0' + minutes
            }
            if(minutes === '00') { 
                minute.classList.add('zero-text')
            }   else {  
                minute.classList.remove('zero-text')
            }


            let seconds = ((millis % 60000) / 1000).toFixed(0);
            if(seconds > 59){
                seconds = 0;
            }
            if (seconds < 10) {
                seconds = '0' + seconds
            }
            if(seconds === '00') { 
                second.classList.add('zero-text')
            }   else {  
                second.classList.remove('zero-text')
            }

            writeTimeInDom(hours, minutes, seconds)
            // return hours + " : " + (minutes < 10 ? '0' : '') + minutes + " : " + (seconds < 10 ? '0' : '') + seconds;
    }

    function writeTimeInDom(hours, minutes, seconds) { 
        hour.innerHTML = hours
        minute.innerHTML = minutes
        second.innerHTML = seconds
    }
    if(localStorage.getItem('timerFinishTime') === null  ){
        StartTimer()  
    } 
})();